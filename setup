#!/usr/bin/env bash

set -e  # Exit on error

echo "Setting up Rust toolchain..."

# Check if rustup is already installed
if command -v rustup &> /dev/null; then
    echo "rustup already installed, updating..."
    rustup update
else
    echo "Installing rustup..."
    curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
    
    # Source cargo env for current shell
    source "$HOME/.cargo/env"
fi

# Verify installation
if command -v cargo &> /dev/null; then
    echo "✓ Cargo installed successfully: $(cargo --version)"
else
    echo "✗ Cargo installation failed"
    exit 1
fi

echo "Rust setup complete!"
echo ""
echo "To use Cargo in your current shell, run:"
echo "  source \"\$HOME/.cargo/env\""
